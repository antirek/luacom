<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>LuaCOM: Введение</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<link rel="StyleSheet" href="common_css.css">
<script type="text/javascript" src="script.js"></script>
<object id=hhctrl classid="clsid:ADB880A6-D8FF-11CF-9377-00AA003B7A11" width=0 height=0 vspace=0 hspace=0 border=0 type="application/x-oleobject"></object>
</head>
<body>
<div class="post translation shortcuts_item">
<div class="content html_format">
<a name="1"></a>
<div class="head0"><h1 class="title"><font size=5>Глава 1</font></h1></div>
<h3>Введение</h3>
LuaCOM это библиотека дополнений к языку Lua, что позволяет программам Lua использовать и реализовывать объекты, которые придерживаются спецификации <a class=popupspot href="JavaScript:hhctrl.TextPopup('объектная модель компонентов; (произносится как &quot;ком&quot;) — это технологический стандарт от компании Microsoft, предназначенный для создания программного обеспечения на основе взаимодействующих компонентов, каждый из которых может использоваться во многих программах одновременно. Стандарт воплощает в себе идеи полиморфизма и инкапсуляции объектно-ориентированного программирования.','Arial,9',10,10,0xffffff,0xd69967)">Component Object Model (COM)</a> от Microsoft и используют <a class=popupspot href="JavaScript:hhctrl.TextPopup('технология компании Microsoft, позволяющая обращаться к COM-объектам из интерпретаторов скриптовых языков, таких, как VBScript (на настоящий момент поддержка обращений к OA-объектам есть в Windows-версиях всех популярных скриптовых языков).\r\nОбъектами OLE Automation являются все элементы управления ActiveX (OCX-контролы). Свойства, методы и события этих компонент реализованы с помощью OLE Automation.','Arial,9',10,10,0xffffff,0xd69967)">технологию Automation</a> для обращения к свойствам и вызова методов.
<a name="1.1"></a>
<h4>1.1 Свойства</h4>
В настоящее время библиотека LuaCOM поддерживает следующие функции:
<ul><li>динамическое создание экземпляра (инстанцирование) объектов COM, зарегистрированных в системном реестре, через метод <tt>CreateObject</tt>;</li>
<li>динамический доступ для запуска объектов COM с помощью <tt>GetObject</tt>;</li>
<li>вызовы метода COM как обычной функции Lua и обращение к свойствам подобно обращению к полю обычной таблицы;</li>
<li>для объектов COM имеется возможность считывания типов библиотек и генерирование документов HTML &#171;на лету&#187;;</li>
<li>использование объектов COM без информации о типе;</li>
<li>преобразование типов между типами <a class=popupspot href="JavaScript:hhctrl.TextPopup('технология компании Microsoft, позволяющая обращаться к COM-объектам из интерпретаторов скриптовых языков, таких, как VBScript (на настоящий момент поддержка обращений к OA-объектам есть в Windows-версиях всех популярных скриптовых языков).\r\nОбъектами OLE Automation являются все элементы управления ActiveX (OCX-контролы). Свойства, методы и события этих компонент реализованы с помощью OLE Automation.','Arial,9',10,10,0xffffff,0xd69967)">OLE Automation</a> и Lua;</li>
<li>утилизация объекта при помощи механизма сбора мусора Lua;</li>
<li>реализация интерфейсов и объектов COM при помощи Lua таблиц;</li>
<li>реализация элементов управления (контролов) OLE при помощи Lua таблиц (требуется набор инструментов Lua GUI, который может создавать окна в нужном месте, вроде <a class=popupspot href="JavaScript:hhctrl.TextPopup('Кроссплатформенная библиотека базовых элементов графического пользовательского интерфейса с использованием языков C и Lua. С его помощью можно создавать быстрые, не требующие компиляции графические приложения.','Arial,9',10,10,0xffffff,0xd69967)">IUP</a>);</li>
<li>использование механизма точек соединения COM для двунаправленной связи и обработки событий;</li>
<li>полная совместимость с Lua 5.1;</li>
<li>механизм логирования (ведение журнала) для облегчения отладки приложений.</li></ul>
<a name="1.2"></a>
<h4>1.2 Кому и что нужно читать</h4>
<div style="margin-left:40px; margin-top: -20px; margin-bottom: 5px;"><font size=2 color="#a0a0a0">(или об этом руководстве)</font></div>
Данное руководство является в основном справочником. Здесь мы задокументировали поведение LuaCOM в различных ситуациях, некоторые решения по реализации, что влияют на конечного пользователя библиотеки, а также ее ограничения.
При встрече с некоторым странным поведением программы, написанной с использованием LuaCOM, первым делом следует прочесть <a href=release_info.htm>главу 5</a>, где описано большинство возможных проблем.
Там же можно найти ссылки на другие разделы данного руководства, где представлена более подробная информация.<br><br>
<b>Новичкам</b> Для тех, кто только начинает изучение данного предмета, мы предоставляем учебный раздел (Глава 2 <a href=tutorial.htm>Руководство</a>), где пошагово изучается начало работы с LuaCOM.
Больше справочной информации и примеров можно найти на <a href="https://github.com/davidm/luacom" target=_blank>домашней странице LuaCOM</a> и в папке <a href="https://github.com/davidm/luacom/tree/master/demo" target=_blank>demo</a>. Обратите внимание, что код VBScript может быть легко преобразован с помощью LuaCOM в код Lua.<br>
Это руководство не предоставляет информацию для разработчиков, которым требуется глубокие технические знания о LuaCOM или тем, кто желает изменить его по каким-либо причинам.
Для такого рода сведений, пожалуйста свяжитесь с авторами.<br><br>
<b>Требуемые знания</b> Это руководство предполагает некоторые знания о COM и  OLE Automation.
Мы не намерены подробно объяснять как работают эти технологии и как можно использовать их для решения конкретных задач.
Такую информацию можно легко найти в Интернете или соответствующих книгах.<br>
<div style="margin-left:30px;">Например:<br>Статья Тома Армстронга <a href="https://rsdn.ru/article/com/introcom.xml#EZEAI" target=_blank>Введение в COM</a> на RSDN<br>
Статья о <a href="https://ru.wikipedia.org/wiki/Component_Object_Model" target=_blank>Component Object Model</a> в Википедии<br>
Статья о <a href="https://ru.wikipedia.org/wiki/Microsoft_OLE_Automation" target=_blank>Microsoft OLE Automation</a> в Википедии<br>
<a href="http://www.developing.ru/com/" target=_blank>Архив статей "Что такое "технология COM"</a></div>
<h6>Некоторые сведения о примерах</h6>
Все коды примеров, показанные в данном документе, написаны на Lua 5.1. Примеры для предыдущих версий Lua можно найти в документации к более ранним версиям LuaCOM.<br><br>
<hr width=90%>
<div align=center style="margin-left:5%; margin-right:5%;">LuaCOM был разработан Renato Cerqueira, Vinicius Almendra и Fabio Mascarenhas.<br>
Проект финансируется компанией TeCGraf<br>(Technology Group on Computer Graphics).
</div></div></div>
<br><br>
</body>
</html>